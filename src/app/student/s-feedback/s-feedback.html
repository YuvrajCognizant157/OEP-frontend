<div class="feedback-panel">
    
    <h2>My Submitted Feedback</h2>
    
    <mat-tab-group animationDuration="300ms" dynamicHeight class="feedback-tab-group">
        
        <mat-tab label="Exam Feedback">
            <div class="tab-content-wrapper">
                
                <div *ngIf="isLoadingExams()" class="loading-indicator">
                    <mat-spinner diameter="30" color="accent"></mat-spinner> Loading Exam Feedback...
                </div>
                
                <div *ngIf="!isLoadingExams()">
                    <h3>Feedback for Full Exams ({{ examFeedbacks().length }})</h3>

                    <table mat-table [dataSource]="examFeedbacks()" class="full-width-table mat-elevation-z4">

                        <ng-container matColumnDef="eid">
                            <th mat-header-cell *matHeaderCellDef> Exam ID </th>
                            <td mat-cell *matCellDef="let element"> {{element.eid}} </td>
                        </ng-container>

                        <ng-container matColumnDef="examName">
                            <th mat-header-cell *matHeaderCellDef> Exam Name </th>
                            <td mat-cell *matCellDef="let element"> {{element.examName}} </td>
                        </ng-container>

                        <ng-container matColumnDef="feedbackText">
                            <th mat-header-cell *matHeaderCellDef> Feedback </th>
                            <td mat-cell *matCellDef="let element" class="feedback-cell"> {{element.feedbackText | slice:0:70}}<span *ngIf="element.feedbackText.length > 70">...</span> </td>
                        </ng-container>
                        
                        <tr mat-header-row *matHeaderRowDef="examDisplayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: examDisplayedColumns;"></tr>
                    </table>
                    
                    <p *ngIf="examFeedbacks().length === 0" class="no-data">No exam feedback submitted yet.</p>
                </div>
            </div>
        </mat-tab>

        <mat-tab label="Question Feedback">
            <div class="tab-content-wrapper">
                
                <div *ngIf="isLoadingQuestions()" class="loading-indicator">
                    <mat-spinner diameter="30" color="accent"></mat-spinner> Loading Question Feedback...
                </div>
                
                <div *ngIf="!isLoadingQuestions()">
                    <h3>Feedback for Specific Questions ({{ questionFeedbacks().length }})</h3>

                    <table mat-table [dataSource]="questionFeedbacks()" class="full-width-table mat-elevation-z4">

                        <ng-container matColumnDef="qId">
                            <th mat-header-cell *matHeaderCellDef> Q. ID </th>
                            <td mat-cell *matCellDef="let element"> {{element.qId}} </td>
                        </ng-container>

                        <ng-container matColumnDef="feedback">
                            <th mat-header-cell *matHeaderCellDef> Feedback Text </th>
                            <td mat-cell *matCellDef="let element" class="feedback-cell"> {{element.feedback | slice:0:70}}<span *ngIf="element.feedback.length > 70">...</span> </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="questionDisplayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: questionDisplayedColumns;"></tr>
                    </table>
                    
                    <p *ngIf="questionFeedbacks().length === 0" class="no-data">No question feedback submitted yet.</p>
                </div>
            </div>
        </mat-tab>
        
    </mat-tab-group>

</div>