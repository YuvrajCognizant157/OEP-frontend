<div class="update-modal-overlay" *ngIf="isOpen" (click)="onModalClick($event)">
  <div class="modal-content">
    <div class="modal-header">
      <h3>Update Exam: {{ examData?.examName }}</h3>
      <button class="close-button" (click)="onClose()">&times;</button>
    </div>
    
    <div class="modal-body">
      <div *ngIf="errorMessage()" class="alert-error">
        {{ errorMessage() }}
      </div>

      <form [formGroup]="updateForm" (ngSubmit)="onUpdate()">
        
        <div class="form-group">
          <label for="name">Exam Name</label>
          <input id="name" type="text" formControlName="name" />
        </div>

        <div class="form-group">
          <label for="description">Description</label>
          <textarea id="description" formControlName="description"></textarea>
        </div>

        <div class="form-group-row">
          <div class="form-group">
            <label for="duration">Duration (mins)</label>
            <input id="duration" type="number" formControlName="duration" />
          </div>
          <div class="form-group">
            <label for="totalQuestions">Total Questions</label>
            <input id="totalQuestions" type="number" formControlName="totalQuestions" />
          </div>
        </div>

        <div class="form-group-row">
          <div class="form-group">
            <label for="marksPerQuestion">Marks Per Question</label>
            <input id="marksPerQuestion" type="number" formControlName="marksPerQuestion" />
          </div>
          <div class="form-group">
            <label for="displayedQuestions">Displayed Questions</label>
            <input id="displayedQuestions" type="number" formControlName="displayedQuestions" />
          </div>
        </div>

        <div class="form-group topic-selection">
          <label>Select Topics</label>
          <div class="topic-grid">
            @for (topic of topics(); track topic.tid) {
              <div class="topic-item">
                <input 
                  type="checkbox" 
                  [id]="'topic-' + topic.tid" 
                  (change)="onTopicChange($event, topic.tid)" 
                  [checked]="isTopicSelected(topic.tid)"
                />
                <label [for]="'topic-' + topic.tid">{{ topic.subject }}</label>
              </div>
            } @empty {
              <p>Loading topics...</p>
            }
          </div>
        </div>

        <button type="submit" [disabled]="updateForm.invalid || isLoading()">
          {{ isLoading() ? 'Updating...' : 'Save Changes' }}
        </button>
      </form>
    </div>
  </div>
</div>