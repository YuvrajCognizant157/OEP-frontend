<mat-card class="upload-card">
  <mat-card-header>
    <mat-card-title>Upload Question List</mat-card-title>
    <mat-card-subtitle>Import questions from an Excel file</mat-card-subtitle>
  </mat-card-header>
  
  <mat-card-content>
    <div class="instructions">
      <mat-icon class="icon">upload_file</mat-icon>
      <p><strong>Instructions:</strong></p>
      <ul>
        <li>Prepare an Excel file (.xlsx or .xls) with the following columns: <strong>questionname, option1, option2, option3, option4, type, correctoptions, tid</strong>.</li>
        <li>Ensure column names are exactly as specified (case-sensitive).</li>
        <li>File size must not exceed 50 MB.</li>
        <li>Provide Topic ID (Tid) and optionally Exam ID (Eid).</li>
        <li>Each row represents a question; tid in the file may be overridden by the provided Tid if applicable.</li>
      </ul>
    </div>
    
    <form [formGroup]="uploadForm" (ngSubmit)="onSubmit()">
      <!-- <mat-form-field appearance="fill" class="full-width">
        <mat-label>Topic ID (Tid)</mat-label>
        <input matInput type="number" formControlName="tid" min="1" required>
        <mat-error *ngIf="uploadForm.get('tid')?.hasError('required')">Tid is required</mat-error>
        <mat-error *ngIf="uploadForm.get('tid')?.hasError('min')">Tid must be greater than 0</mat-error>
      </mat-form-field> -->
      
      <mat-form-field appearance="fill" class="full-width">
        <mat-label>Exam ID (Eid) - Optional</mat-label>
        <input matInput type="number" formControlName="eid">
      </mat-form-field>
      
      <div class="file-upload">
        <input #fileInput type="file" id="fileInput" (change)="onFileSelected($event)" accept=".xlsx, .xls" hidden>
        <button mat-raised-button color="primary" (click)="fileInput.click()">
          <mat-icon>attach_file</mat-icon> Select Excel File
        </button>
        <span class="file-name" *ngIf="selectedFile as file">{{ file.name }}</span>
      </div>
      
      <button mat-raised-button color="accent" type="submit" [disabled]="isUploading || uploadForm.invalid">
        <mat-spinner *ngIf="isUploading" diameter="20"></mat-spinner>
        <span *ngIf="!isUploading">Upload</span>
      </button>
    </form>
  </mat-card-content>
</mat-card>